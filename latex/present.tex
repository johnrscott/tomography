\documentclass{beamer}
\beamertemplatenavigationsymbolsempty
\usepackage[style=verbose,backend=biber,url=false,doi=false,giveninits=true]{biblatex}
\bibliography{ref.bib}
\usepackage{color}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.4}
\setbeamertemplate{bibliography item}{}

\title{Comparison of estimators in quantum tomography}
\author{John Scott}
\date{\today}

\begin{document}
\begin{frame}
  \titlepage
\end{frame}


\begin{frame}
  \frametitle{Introduction}
  \begin{itemize}
  \item \textbf{The original motivation:} converting classical signal processing to quantum signal processing (originality: $100\%$)
  \item \textbf{The plan for project B:} time varying quantum tomography (originality: $80\%$)
  \item \textbf{Step one of the plan:} look into estimators for steady state quantum tomography (originality: $20\%$)
  \item \textbf{What I actually did:} look into estimators for quantum state tomography with one qubit (originality: $0\%$)
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{What is quantum state tomography}
  \begin{itemize}
  \item State estimation. You need many copies of the state because you need to be able to make repeated measurements and build up statistics.
  \item You can use it for characterizing the results from experiments (levels of entanglement, etc.)
  \item It can also be used to obtain information about quantum processes or channels:
    \begin{enumerate}
    \item Put a known state into the process
    \item Do quantum state tomography on the output
    \item Infer the process
    \end{enumerate}
    \item This is called quantum process tomography
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Simulating quantum tomography}
  \begin{itemize}
  \item{ Simulate data
      \begin{enumerate}
      \item Generate a density matrix representing a state
      \item Pick a measurement basis
      \item Simulate measurement data based on the density matrix
      \end{enumerate}
  }
  \item{State tomography
    \begin{enumerate}
        \setcounter{enumi}{3}
      \item {\color{blue}Use the simulated measurement data to obtain an estimate of the density matrix}
      \end{enumerate}
    }
  \item{Check the quality of the estimate
    \begin{enumerate}
        \setcounter{enumi}{4}
      \item Compare the estimated density matrix with the original density matrix
      \end{enumerate}
    }
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Quality of the esimate (loss functions): distance measures and fidelity}
  \begin{itemize}
  \item{
      I looked into the trace distance, the Hilbert-Schmidt distance, and the infidelity\footcite{PhysRevLett.111.160406}:
      \begin{equation}T(A,B) = \frac{1}{2} Tr|A - B|\end{equation}
      \begin{equation}HS(A,B) = \frac{1}{\sqrt{2}} \left[tr(A - B)^2\right]^{\frac{1}{2}}\end{equation}
      \begin{equation}IF(A,B) = 1 - \left[tr\sqrt{A^{\frac{1}{2}}BA^{\frac{1}{2}}}\right]^2\end{equation}
    }
  \item{There are many others: operator norm, fidelity-derived distance, etc.}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Practical aspects of the simulation}
  \begin{itemize}
  \item{Simulation details:
      \begin{enumerate}
      \item Divided purity values into {\color{blue}2000} steps, and generated {\color{blue}500} single-qubit density matrices for each value
      \item Simulated {\color{blue}500} measurements each of X, Y and Z
      \item Use the simulated measurement data to obtain an estimate of the density matrix -- repeat for each of the matrices
      \item Compute the three loss functions between each matrix, and average for each purity
      \end{enumerate}
  }
  \item C++\footnote{Or FORTRAN}, not python! (There are 1 million density matrix estimations. That takes a while if each of them involves an optimisation). 
  \item 
  \end{itemize}
  \end{frame}


\begin{frame}
  \frametitle{Using expectation values to estimate the density matrix}
  \begin{itemize}
  \item {The simplest way to do tomography is to just compute a density matrix from expectation values:
    \begin{equation}
      \rho = \frac{1}{2} (I + aX + bY + cZ) = \frac{1}{2}\begin{bmatrix} 1 + c & a - ib \\ a + ib & 1 -c\end{bmatrix}    
    \end{equation}
  }
\item The matrix will come out Hermitian and trace 1, but might not have positive eigenvalues (so it isn't `physical'). This problem gets worse depending on how pure the state is.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Quality of the linear estimate}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        xlabel={Purity},
        axis x line = bottom,
        enlarge x limits={rel=0.1},
        ylabel={Error},
        axis y line = left,
        enlarge y limits={rel=0.2},
        grid=both,
        grid style={dotted,gray!70!white!},
        width=0.9\textwidth,
        height=0.8\textheight,
        scaled ticks=false,
        yticklabel style = {/pgf/number format/.cd,fixed,fixed zerofill, precision=3},
        legend style={font=\small,at={(0.7,0.4)},anchor=center},
        legend image post style={scale=5},
        legend cell align={left}
        ]
        \addplot[red,only marks,mark size=0.3] table [x={PURITY}, y={TRACE}, col sep=comma] {linear-data-example.dat};
        \addlegendentry{Trace}
        \addplot[green,only marks,mark size=0.3] table [x={PURITY}, y={HILBERT-SCHMIDT}, col sep=comma] {linear-data-example.dat};
        \addlegendentry{Hilbert-Schmidt}
        \addplot[blue,only marks,mark size=0.3] table [x={PURITY}, y={INFIDELITY}, col sep=comma] {linear-data-example.dat};
        \addlegendentry{Infidelity}
      \end{axis}

    \end{tikzpicture}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Physicality of the linear estimate}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        xlabel={Purity},
        axis x line = bottom,
        enlarge x limits={rel=0.1},
        ylabel={Probability},
        axis y line = left,
        enlarge y limits={rel=0.2},
        grid=both,
        grid style={dotted,gray!70!white!},
        width=0.9\textwidth,
        height=0.8\textheight,
        scaled ticks=false,
        yticklabel style = {/pgf/number format/.cd,fixed,fixed zerofill, precision=3},
        legend style={font=\small,at={(0.7,0.4)},anchor=center},
        legend image post style={scale=5},
        legend cell align={left}
        ]
        \addplot[brown,only marks,mark size=0.3] table [x={PURITY}, y={NON PHYSICAL}, col sep=comma] {linear-data-example.dat};
        \addlegendentry{Non-physical}
      \end{axis}

    \end{tikzpicture}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Extended norm minimisation: producing a physical density matrix}
  \begin{itemize}
  \item If you want physical estimates you can try to obtain them from the linear estimate somehow.
  \item The simplest method is to take the linear estimate and project it onto the space of physical states. That's called extended norm minimisation \footcite{PhysRevLett.111.160406}
  \item First obtain the linear estimate $\rho_1$
  \item Then find the closest physical density matrix $\rho_2$ using $$\rho_2 = \min_{\rho} \lVert \rho - \rho_1\rVert_2$$
  \item This result of this estimator is always physical
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Doing ENM in practice}
  You need to find an optimiser which will minimise the $L^2$ distance between your (fixed) linear estimate and a (varying) physical density matrix. Parametrizing the space of physical density matrices can be done by writing \footcite{banaszek1999maximum}
  \begin{equation}
    T = \begin{bmatrix}w&x+iy\\0&z\end{bmatrix}
  \end{equation}
  \begin{equation}
    \rho = T^\dagger T
  \end{equation}
  Then $\rho$ is positive and hermitian. The trace 1 condition (physicality) is given by requiring that
  \begin{equation}
    w^2+x^2+y^2+z^2=1
  \end{equation}
\end{frame}

\begin{frame}
  \frametitle{Quality of the ENM estimate}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        xlabel={Purity},
        axis x line = bottom,
        enlarge x limits={rel=0.1},
        ylabel={Error},
        axis y line = left,
        enlarge y limits={rel=0.2},
        grid=both,
        grid style={dotted,gray!70!white!},
        width=0.9\textwidth,
        height=0.8\textheight,
        scaled ticks=false,
        yticklabel style = {/pgf/number format/.cd,fixed,fixed zerofill, precision=3},
        legend style={font=\small,at={(0.7,0.4)},anchor=center},
        legend image post style={scale=5},
        legend cell align={left}
        ]
        \addplot[red,only marks,mark size=0.3] table [x={PURITY}, y={TRACE}, col sep=comma] {enm-data-example.dat};
        \addlegendentry{Trace}
        \addplot[green,only marks,mark size=0.3] table [x={PURITY}, y={HILBERT-SCHMIDT}, col sep=comma] {enm-data-example.dat};
        \addlegendentry{Hilbert-Schmidt}
        \addplot[blue,only marks,mark size=0.3] table [x={PURITY}, y={INFIDELITY}, col sep=comma] {enm-data-example.dat};
        \addlegendentry{Infidelity}
      \end{axis}

    \end{tikzpicture}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Physicality of the ENM estimate}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
        xlabel={Purity},
        axis x line = bottom,
        enlarge x limits={rel=0.1},
        ylabel={Probability},
        axis y line = left,
        enlarge y limits={rel=0.2},
        grid=both,
        grid style={dotted,gray!70!white!},
        width=0.9\textwidth,
        height=0.8\textheight,
        scaled ticks=false,
        yticklabel style = {/pgf/number format/.cd,fixed,fixed zerofill, precision=3},
        legend style={font=\small,at={(0.7,0.4)},anchor=center},
        legend image post style={scale=5},
        legend cell align={left}
        ]
        \addplot[brown,only marks,mark size=0.3] table [x={PURITY}, y={NON PHYSICAL}, col sep=comma] {enm-data-example.dat};
        \addlegendentry{Non-physical}
      \end{axis}

    \end{tikzpicture}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Other methods: maximum likelihood}
  \begin{itemize}
  \item You can also use maximum likelihood to get physical estimates.
  \item Maximum likelihood estimation uses a likelihood function $L(\rho)$ which assesses how well a given density matrix $\rho$ explains measured data: $$L(\rho) = \prod_k tr(\rho \Pi_k)^{n_k}$$
  \item Taking the logarithm of the above expression is a good idea, to reduce the dynamic range of the expression.
    \item I didn't implement the maximum likelihood method
  \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Conclusions}
\begin{itemize}
\item There are plenty of ways to assess quality of estimates, which aren't necessarily correlated
\item The simplest method of tomography (the linear estimate) also produced the closest estimates
\item More advanced techniques involving optimisation are harder to implement and did not produce better estimates than the linear case.
\item The ENM estimator is good because it comes with a confidence interval for the estimate
\item Compiled languages are better for tomography because life is too short for python!
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Future work}
\begin{itemize}
\item There are plenty of ways to assess quality of estimates, which aren't necessarily correlated
\item The simplest method of tomography (the linear estimate) also produced the closest estimates
\item More advanced techniques involving optimisation are harder to implement and did not produce better estimates than the linear case.
\item The ENM estimator is good because it comes with a confidence interval for the estimate
\item Compiled languages are better for tomography simulation because life is too short for python!
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{References}
% This prints the bibliography on the slide
\printbibliography
\end{frame}



\end{document}
